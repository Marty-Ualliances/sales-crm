(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,14764,e=>{"use strict";let t=(0,e.i(75254).default)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],14764)},69618,e=>{"use strict";let t=[{key:"cold-14day",label:"Cold 14-Day",description:"Standard cold outreach — 7 touches over 14 days",touches:[{day:1,type:"call",label:"Initial Call"},{day:1,type:"email",label:"Intro Email"},{day:2,type:"call",label:"Follow-up Call"},{day:2,type:"linkedin",label:"LinkedIn Connect"},{day:4,type:"call",label:"Check-in Call"},{day:4,type:"email",label:"Value Prop Email"},{day:6,type:"call",label:"Persistence Call"},{day:8,type:"email",label:"Value CTA Email"},{day:10,type:"call",label:"Re-engage Call"},{day:14,type:"email",label:"Breakup Email"}]},{key:"warm-fast",label:"Warm Fast",description:"Accelerated outreach for warm/engaged leads — 5 touches in 3 days",touches:[{day:0,type:"call",label:"Immediate Call"},{day:0,type:"email",label:"Quick Follow-up Email"},{day:1,type:"call",label:"Next Morning Call"},{day:1,type:"linkedin",label:"LinkedIn Message"},{day:2,type:"call",label:"Close Call"},{day:3,type:"email",label:"Last Touch Email"}]}];function s(e){if(!e?.startedAt||!e.touches)return{due:[],overdue:[],upcoming:[],progress:0};let s=new Date(e.startedAt),a=Math.floor((new Date().getTime()-s.getTime())/864e5),r=t.find(t=>t.key===e.type),l=[],d=[],i=[];e.touches.forEach((e,t)=>{if(e.completed)return;let s=r?.touches[t],n=s?.day??e.day;n<a?d.push(e):n===a?l.push(e):i.push(e)});let n=e.touches.filter(e=>e.completed).length;return{due:l,overdue:d,upcoming:i,progress:e.touches.length>0?Math.round(n/e.touches.length*100):0}}e.s(["CADENCE_TEMPLATES",0,t,"TOUCH_TYPE_CONFIG",0,{call:{icon:"Phone",color:"text-emerald-500",bg:"bg-emerald-100 dark:bg-emerald-900/40"},email:{icon:"Send",color:"text-blue-500",bg:"bg-blue-100 dark:bg-blue-900/40"},linkedin:{icon:"Linkedin",color:"text-sky-500",bg:"bg-sky-100 dark:bg-sky-900/40"}},"getCadenceTasks",()=>s])},18724,e=>{"use strict";let t=(0,e.i(75254).default)("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]);e.s(["PhoneCall",()=>t],18724)},7486,e=>{"use strict";let t=(0,e.i(75254).default)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);e.s(["Building2",()=>t],7486)},52562,e=>{"use strict";var t=e.i(43476),s=e.i(18566),a=e.i(22016),r=e.i(71689),l=e.i(43432),d=e.i(63488),i=e.i(84614),n=e.i(87316),o=e.i(78583),c=e.i(16715),m=e.i(31278),x=e.i(7486),u=e.i(75254);let h=(0,u.default)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),p=(0,u.default)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);var g=e.i(51348),f=e.i(61911),b=e.i(69638),y=e.i(18724),j=e.i(14764);let N=(0,u.default)("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var v=e.i(78894),w=e.i(19455);e.i(64862);var k=e.i(9085),C=e.i(82013),S=e.i(32693),P=e.i(18685),A=e.i(69618),M=e.i(46696),T=e.i(71645);function L(e){return`tel:${e.replace(/[^+\d]/g,"")}`}let E={call:l.Phone,"follow-up":n.Calendar,note:o.FileText,"status-change":c.RefreshCw,email:j.Send,linkedin:g.Linkedin,"cadence-touch":b.CheckCircle},D={call:"bg-success/10 text-success","follow-up":"bg-warning/10 text-warning",note:"bg-muted text-muted-foreground","status-change":"bg-primary/10 text-primary",email:"bg-blue-100/50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400",linkedin:"bg-sky-100/50 text-sky-600 dark:bg-sky-900/30 dark:text-sky-400","cadence-touch":"bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400"};function $(){let e,u=(0,s.useParams)(),b=u?.leadId,{data:j,isLoading:$}=(0,k.useLead)(b??""),{data:B=[]}=(0,C.useCalls)();(0,k.useCompleteFollowUp)();let I=(0,k.useUpdateLead)(),q=(0,C.useCreateCall)(),{user:U}=(0,S.useAuth)(),{data:F=[]}=(0,k.useLeads)(),[_,z]=(0,T.useState)(!1),[O,R]=(0,T.useState)(""),[G,H]=(0,T.useState)(null),[Q,W]=(0,T.useState)(""),[V,K]=(0,T.useState)(""),[Y,J]=(0,T.useState)("team"),Z=(0,s.usePathname)()??"",X=Z.startsWith("/sdr")?"/sdr":Z.startsWith("/hr")?"/hr":Z.startsWith("/leadgen")?"/leadgen":"/admin";if($)return(0,t.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,t.jsx)(m.Loader2,{className:"h-8 w-8 animate-spin text-primary"})});if(!j)return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-20",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-foreground mb-2",children:"Lead not found"}),(0,t.jsx)(a.default,{href:`${X}/leads`,children:(0,t.jsx)(w.Button,{variant:"outline",children:"Back to Leads"})})]});let ee=B.filter(e=>e.leadId===j.id||e.leadId===j._id),et=async e=>{let t=e||j.phone||j.companyPhone;if(!t)return void M.toast.error("No phone number available");try{await q.mutateAsync({leadId:j.id||j._id,leadName:j.name,agentName:U?.name||"Unknown",date:new Date,time:new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),duration:"0 min",status:"Completed",notes:"Call initiated from Lead Details",hasRecording:!1})}catch(e){console.error("Failed to log call:",e)}window.location.href=L(t),M.toast.success("Call logged and opening dialer...")},es=["Qualified","Meeting Booked","Meeting Completed","Proposal Sent","Negotiation"],ea=async e=>{if(es.includes(e)){W(""),K(""),H({status:e});return}try{await I.mutateAsync({id:j.id,data:{status:e}}),M.toast.success(`Status changed to ${e}`)}catch{M.toast.error("Failed to update status")}},er=async()=>{if(G)try{let e={status:G.status};Q&&(e.nextFollowUp=Q),V&&(e.activities=[...j.activities||[],{type:"note",description:`Next step: ${V}`,timestamp:new Date().toISOString(),agent:j.assignedAgent||"User"}]),await I.mutateAsync({id:j.id,data:e}),M.toast.success(`Status changed to ${G.status}`)}catch{M.toast.error("Failed to update status")}finally{H(null)}},el=async()=>{try{let e="Current User";try{let t=localStorage.getItem("insurelead_user");t&&(e=JSON.parse(t).name||"Current User")}catch(e){}let t={type:"note",description:O,timestamp:new Date().toISOString(),agent:e};await I.mutateAsync({id:j.id,data:{activities:[t,...j.activities||[]]}}),z(!1),R(""),M.toast.success("Notes saved")}catch{M.toast.error("Failed to save notes")}},ed=async e=>{try{await I.mutateAsync({id:j.id,data:e}),M.toast.success("Updated")}catch{M.toast.error("Failed to update")}},ei=async e=>{let t=j.qualification||{rightPerson:!1,realNeed:!1,timing:!1,qualifiedAt:null,qualifiedBy:""},s={...t,[e]:!t[e]};s.rightPerson&&s.realNeed&&s.timing&&!t.qualifiedAt&&(s.qualifiedAt=new Date().toISOString(),s.qualifiedBy=j.assignedAgent),await ed({qualification:s})},en=(0,P.checkQualityGate)(j);(0,A.getCadenceTasks)(j.cadence),j.cadence&&A.CADENCE_TEMPLATES.find(e=>e.key===j.cadence.type);let eo=[{label:"Work Direct",value:j.workDirectPhone},{label:"Mobile",value:j.mobilePhone},{label:"Home",value:j.homePhone},{label:"Corporate",value:j.corporatePhone},{label:"Company",value:j.companyPhone},{label:"Other",value:j.otherPhone}].filter(e=>e.value),ec=("Meeting Completed"===j.status||"Negotiation"===j.status)&&!j.nextFollowUp,em=[...j.activities||[],...(j.stageHistory||[]).map((e,t)=>({id:`sh-${t}-${e.enteredAt}`,type:"status-change",description:`Status changed to ${e.stage}`,timestamp:e.enteredAt,agent:e.agent||"System"}))].sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()),ex=em.filter(e=>"note"===e.type),eu=em.filter(e=>"note"!==e.type);return(0,t.jsxs)("div",{className:"space-y-6",children:[ec&&(0,t.jsxs)("div",{className:"flex items-center gap-3 rounded-xl border border-amber-200 bg-amber-50 dark:bg-amber-950/20 dark:border-amber-900/40 px-4 py-3",children:[(0,t.jsx)(v.AlertTriangle,{className:"h-4 w-4 text-amber-600 shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-amber-800 dark:text-amber-300",children:"No next step set"}),(0,t.jsxs)("p",{className:"text-xs text-amber-700 dark:text-amber-400",children:["This lead is in ",(0,t.jsx)("strong",{children:j.status})," but has no follow-up date. Set one below to keep the deal moving."]})]})]}),G&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-foreground/40 backdrop-blur-sm p-4",children:(0,t.jsxs)("div",{className:"w-full max-w-md rounded-2xl border border-border bg-card p-6 shadow-xl space-y-4",children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-foreground",children:"Set Next Step"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Moving to ",(0,t.jsx)("span",{className:"font-semibold text-foreground",children:G.status})," — define what happens next to keep momentum."]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Follow-up Date"}),(0,t.jsx)("input",{type:"date",value:Q,onChange:e=>W(e.target.value),className:"w-full h-9 rounded-lg border border-input bg-background px-3 text-sm text-foreground"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Next Step Note"}),(0,t.jsx)("input",{value:V,onChange:e=>K(e.target.value),placeholder:"e.g. Send proposal, Book demo, Follow up on budget...",className:"w-full h-9 rounded-lg border border-input bg-background px-3 text-sm text-foreground placeholder:text-muted-foreground"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 justify-end pt-2",children:[(0,t.jsx)(w.Button,{variant:"outline",onClick:()=>H(null),children:"Skip"}),(0,t.jsx)(w.Button,{onClick:er,disabled:I.isPending,children:I.isPending?"Saving...":"Confirm & Save"})]})]})}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(a.default,{href:`${X}/leads`,children:(0,t.jsx)(w.Button,{variant:"ghost",size:"icon",className:"h-9 w-9",children:(0,t.jsx)(r.ArrowLeft,{className:"h-4 w-4"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-foreground",children:j.name}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[j.title&&`${j.title} \xb7 `,j.companyName||"Lead Details"]})]})]}),(0,t.jsx)("div",{className:"flex gap-2 ml-12 sm:ml-0",children:j.phone&&(0,t.jsxs)(w.Button,{size:"sm",onClick:()=>et(j.phone),children:[(0,t.jsx)(y.PhoneCall,{className:"h-4 w-4 mr-1"}),"Call Now"]})})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-border bg-card shadow-card p-4 sm:p-8",children:[(0,t.jsxs)("div",{className:"flex items-start gap-4 mb-5",children:[(0,t.jsx)("div",{className:"flex h-14 w-14 items-center justify-center rounded-2xl bg-primary/10 shrink-0",children:(0,t.jsx)(x.Building2,{className:"h-7 w-7 text-primary"})}),(0,t.jsx)("div",{className:"min-w-0 flex-1",children:(0,t.jsx)("h3",{className:"text-xl font-bold text-foreground truncate",children:j.companyName||"Unknown Company"})}),(0,t.jsx)("select",{value:j.status,onChange:e=>ea(e.target.value),className:`cursor-pointer appearance-none outline-none inline-flex items-center rounded-full border px-3 py-1.5 text-xs font-semibold shrink-0 ${(0,P.getStageBadgeClass)(j.status)}`,style:{paddingRight:"1rem"},children:P.PIPELINE_STAGES.map(e=>(0,t.jsx)("option",{value:e.key,className:"bg-background text-foreground",children:e.label},e.key))})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 pt-5 border-t border-border",children:[j.employees&&(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-secondary shrink-0",children:(0,t.jsx)(f.Users,{className:"h-4 w-4 text-muted-foreground"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Employees"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-foreground",children:j.employees})]})]}),j.website&&(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,t.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-secondary shrink-0",children:(0,t.jsx)(p,{className:"h-4 w-4 text-muted-foreground"})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Website"}),(0,t.jsx)("a",{href:j.website,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-semibold text-primary hover:underline truncate block",children:j.website.replace(/^https?:\/\//,"")})]})]}),j.companyLinkedinUrl&&(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,t.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-secondary shrink-0",children:(0,t.jsx)(g.Linkedin,{className:"h-4 w-4 text-muted-foreground"})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"LinkedIn"}),(0,t.jsx)("a",{href:j.companyLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-semibold text-primary hover:underline truncate block",children:"Company Page"})]})]}),j.companyPhone&&(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-secondary shrink-0",children:(0,t.jsx)(l.Phone,{className:"h-4 w-4 text-muted-foreground"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Company Phone"}),(0,t.jsx)("button",{onClick:()=>et(j.companyPhone),className:"text-sm font-semibold text-primary hover:underline",children:j.companyPhone})]})]}),(j.address||j.city||j.state)&&(0,t.jsxs)("div",{className:"flex items-center gap-3 col-span-2 sm:col-span-4",children:[(0,t.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-secondary shrink-0",children:(0,t.jsx)(h,{className:"h-4 w-4 text-muted-foreground"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Address"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-foreground truncate",children:[j.address,j.city,j.state].filter(Boolean).join(", ")})]})]})]})]}),(0,t.jsxs)("div",{className:"mt-8",children:[(0,t.jsx)("div",{className:"border-b border-border",children:(0,t.jsxs)("div",{className:"flex space-x-8 px-2",children:[(0,t.jsxs)("button",{onClick:()=>J("team"),className:`pb-4 text-sm font-medium transition-colors relative ${"team"===Y?"text-primary":"text-muted-foreground hover:text-foreground"}`,children:["Team & Qualifications","team"===Y&&(0,t.jsx)("span",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-primary rounded-t-full"})]}),(0,t.jsxs)("button",{onClick:()=>J("activity"),className:`pb-4 text-sm font-medium transition-colors relative ${"activity"===Y?"text-primary":"text-muted-foreground hover:text-foreground"}`,children:["Activity & Notes","activity"===Y&&(0,t.jsx)("span",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-primary rounded-t-full"})]})]})}),(0,t.jsx)("div",{className:"pt-6",children:"team"===Y?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"rounded-xl border border-border bg-card shadow-card p-4 sm:p-8 space-y-5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"flex h-14 w-14 items-center justify-center rounded-full bg-primary text-primary-foreground text-lg font-bold shrink-0",children:j.name?.split(" ").map(e=>e[0]).join("").slice(0,2)||"LD"}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-foreground",children:j.name}),j.title&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-0.5",children:j.title})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 pt-5 border-t border-border",children:[j.email&&(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-secondary shrink-0",children:(0,t.jsx)(d.Mail,{className:"h-4 w-4 text-muted-foreground"})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Email"}),(0,t.jsx)("p",{className:"text-sm font-medium text-foreground truncate",children:j.email})]})]}),j.assignedAgent&&(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-secondary shrink-0",children:(0,t.jsx)(i.User,{className:"h-4 w-4 text-muted-foreground"})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Assigned Agent"}),(0,t.jsx)("p",{className:"text-sm font-medium text-foreground truncate",children:j.assignedAgent})]})]}),j.date&&(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-secondary shrink-0",children:(0,t.jsx)(n.Calendar,{className:"h-4 w-4 text-muted-foreground"})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Date Added"}),(0,t.jsx)("p",{className:"text-sm font-medium text-foreground",children:j.date})]})]}),j.source&&(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-secondary shrink-0",children:(0,t.jsx)(c.RefreshCw,{className:"h-4 w-4 text-muted-foreground"})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Source"}),(0,t.jsx)("p",{className:"text-sm font-medium text-foreground",children:j.source})]})]})]})]}),j.companyName&&(e=F.filter(e=>e.companyName===j.companyName&&(e.id||e._id)!==(j.id||j._id)),(0,t.jsxs)("div",{className:"rounded-xl border border-border bg-card shadow-card p-6 space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Company Team"}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.length," contact",1!==e.length?"s":""]})]}),e.length>0?(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>(0,t.jsxs)(a.default,{href:`${X}/leads/${e.id||e._id}`,className:"flex items-center gap-3 p-3 rounded-lg border border-border hover:bg-secondary/50 transition-colors",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-secondary text-foreground text-sm font-medium shrink-0",children:e.name?.split(" ").map(e=>e[0]).join("").slice(0,2)||"??"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-foreground truncate",children:e.name}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.title||"No title"})]}),(0,t.jsx)("span",{className:`inline-flex items-center rounded-full border px-2 py-0.5 text-[10px] font-medium shrink-0 ${(0,P.getStageBadgeClass)(e.status)}`,children:e.status})]},e.id||e._id))}):(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["No other contacts from ",j.companyName," yet."]})]})),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"rounded-xl border border-border bg-card shadow-card p-6 space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Classification & Qualification"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-1.5",children:"Priority"}),(0,t.jsx)("div",{className:"flex gap-1.5",children:P.PRIORITIES.map(e=>(0,t.jsx)("button",{onClick:()=>ed({priority:e.key}),className:`inline-flex items-center rounded-full border px-3 py-1 text-xs font-semibold transition-all ${j.priority===e.key?e.badgeClass+" ring-2 ring-offset-1 ring-current":"bg-muted/50 text-muted-foreground border-border hover:bg-muted"}`,children:e.label},e.key))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-1.5",children:"Segment"}),(0,t.jsxs)("select",{value:j.segment||"",onChange:e=>ed({segment:e.target.value}),className:"w-full h-8 rounded-lg border border-input bg-background px-2 text-sm text-foreground",children:[(0,t.jsx)("option",{value:"",children:"— Select —"}),P.SEGMENTS.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-1.5",children:"Source Channel"}),(0,t.jsxs)("select",{value:j.sourceChannel||"",onChange:e=>ed({sourceChannel:e.target.value}),className:"w-full h-8 rounded-lg border border-input bg-background px-2 text-sm text-foreground",children:[(0,t.jsx)("option",{value:"",children:"— Select —"}),P.SOURCE_CHANNELS.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{className:"pt-3 border-t border-border",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[en.pass?(0,t.jsx)(N,{className:"h-4 w-4 text-emerald-500"}):(0,t.jsx)(v.AlertTriangle,{className:"h-4 w-4 text-amber-500"}),(0,t.jsxs)("p",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide",children:["Quality Gate ",en.pass?"✓ Passed":`— ${en.missing.length} missing`]})]}),!en.pass&&(0,t.jsx)("ul",{className:"text-xs text-amber-600 dark:text-amber-400 space-y-0.5 ml-6 list-disc",children:en.missing.map(e=>(0,t.jsx)("li",{children:e},e))})]}),(0,t.jsxs)("div",{className:"pt-3 border-t border-border",children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide mb-2",children:"3 Yes Rule"}),[{key:"rightPerson",label:"Right Person — Decision maker?"},{key:"realNeed",label:"Real Need — Admin/quoting/COIs pain?"},{key:"timing",label:"Timing — Open to change 30-90 days?"}].map(e=>(0,t.jsxs)("label",{className:"flex items-center gap-2.5 py-1.5 cursor-pointer group",children:[(0,t.jsx)("input",{type:"checkbox",checked:j.qualification?.[e.key]||!1,onChange:()=>ei(e.key),className:"h-4 w-4 rounded border-border text-primary focus:ring-primary"}),(0,t.jsx)("span",{className:"text-sm text-foreground group-hover:text-primary transition-colors",children:e.label})]},e.key)),j.qualification?.qualifiedAt&&(0,t.jsxs)("p",{className:"text-xs text-emerald-600 dark:text-emerald-400 mt-1",children:["✓ Qualified on ",new Date(j.qualification.qualifiedAt).toLocaleDateString()," by ",j.qualification.qualifiedBy]})]})]}),eo.length>0&&(0,t.jsxs)("div",{className:"rounded-xl border border-border bg-card shadow-card p-6 space-y-3",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Phone Numbers"}),eo.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-secondary",children:(0,t.jsx)(l.Phone,{className:"h-4 w-4 text-muted-foreground"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.label}),(0,t.jsx)("a",{href:L(e.value),className:"text-sm font-medium text-primary hover:underline",children:e.value})]})]}),(0,t.jsx)("a",{href:L(e.value),title:"Call this number",children:(0,t.jsx)(w.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-primary",children:(0,t.jsx)(y.PhoneCall,{className:"h-3.5 w-3.5"})})})]},e.label))]})]})]}):(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"rounded-xl border border-border bg-card shadow-card p-6 space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Add Note"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("textarea",{value:O,onChange:e=>R(e.target.value),placeholder:"Type a note (visible across all panels)...",className:"w-full h-24 rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground resize-none focus:outline-none focus:ring-2 focus:ring-primary"}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(w.Button,{size:"sm",onClick:el,disabled:!O.trim(),children:"Post Note"})})]})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-border bg-card shadow-card p-6 space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Global Notes History"}),(0,t.jsxs)("div",{className:"space-y-4",children:[ex.map(e=>(0,t.jsxs)("div",{className:"p-4 bg-secondary/30 rounded-lg border border-border/50",children:[(0,t.jsx)("p",{className:"text-sm text-foreground whitespace-pre-wrap",children:e.description}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-2 font-medium flex items-center gap-1.5",children:[(0,t.jsx)("span",{className:"flex h-4 w-4 items-center justify-center rounded-full bg-primary/20 text-[8px] text-primary",children:e.agent?.[0]||"?"}),e.agent," · ",new Date(e.timestamp).toLocaleString()]})]},e.id||e.timestamp)),0===ex.length&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"No notes recorded yet."})]})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"rounded-xl border border-border bg-card shadow-card p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"Activity History"}),(0,t.jsxs)("div",{className:"space-y-4 max-h-[400px] overflow-y-auto pr-2",children:[eu.map(e=>{let s=E[e.type]||o.FileText;return(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-lg ${D[e.type]||"bg-muted text-muted-foreground"}`,children:(0,t.jsx)(s,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm text-foreground",children:e.description}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-0.5",children:[e.agent," · ",new Date(e.timestamp).toLocaleString()]})]})]},e.id||e.timestamp)}),0===eu.length&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"No activities recorded yet."})]})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-border bg-card shadow-card p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Call Logs"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:[ee.length," calls"]})]}),ee.length>0?(0,t.jsx)("div",{className:"space-y-3 max-h-[300px] overflow-y-auto pr-2",children:ee.map(e=>(0,t.jsxs)(a.default,{href:`${X}/calls/${e.id}`,className:"flex items-center gap-3 p-3 rounded-lg hover:bg-secondary/50 transition-colors",children:[(0,t.jsx)("div",{className:`flex h-8 w-8 items-center justify-center rounded-lg ${"Completed"===e.status?"bg-success/10 text-success":"Missed"===e.status?"bg-destructive/10 text-destructive":"bg-warning/10 text-warning"}`,children:(0,t.jsx)(l.Phone,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("p",{className:"text-sm font-medium text-foreground",children:[e.date," at ",e.time," — ",e.duration]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.notes})]}),(0,t.jsx)("span",{className:`inline-flex items-center rounded-full border px-2 py-0.5 text-xs font-medium ${"Completed"===e.status?"bg-success/10 text-success border-success/20":"Missed"===e.status?"bg-destructive/10 text-destructive border-destructive/20":"bg-warning/10 text-warning border-warning/20"}`,children:e.status})]},e.id))}):(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"No calls recorded yet."})]})]})]})})]})]})}e.s(["default",()=>$],52562)}]);